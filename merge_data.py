# importing pandas
import numpy as np
import pandas as pd
from sklearn.metrics import accuracy_score

all_data = pd.read_csv('all_with_topics.csv')[['ID', 'baseScore', 'baseScore_v2']]
data_2017 = pd.read_csv('output_2017.csv')[['ID', 'Base Score']]


df = pd.merge(all_data, data_2017, on='ID', how='right')
print(df.shape)
count = 0
shape = df.shape
for i in range(shape[0]):
    if df['baseScore_v2'][i] == df['Base Score'][i]:
        count += 1


# for i in df.shape:
print("Accuracy: ", count/shape[0])
# df.to_csv('final_2017.csv')

# accuracy = score(df['baseScore'], df['Base Score'])
# # %%
# print(accuracy)
# C = np.where(df['baseScore_v2'] == df['Base Score'], df['baseScore_v2'], df['Base Score'])
# print(C)

#merging 2017..........
# Creating dataframe a
# data = pd.read_csv('data_2017.csv')
# output = pd.read_csv('output_2017.csv')
#
#
# df = pd.merge(data, output, on='ID', how='inner')
#
# df.to_csv('final_2017.csv')