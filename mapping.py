import pandas as pd

map_value = {
    'attackVector': {
        'NETWORK': 0.85,
        'ADJACENT_NETWORK': 0.62,
        'LOCAL': 0.55,
        'PHYSICAL': 0.2
    },
    'attackComplexity': {
        'LOW': 0.77,
        'HIGH': 0.44
    },
    'privilegesRequired': {
        'NONEUNCHANGED': 0.85,
        'NONECHANGED': 0.85,
        'LOWUNCHANGED': 0.62,
        'LOWCHANGED': 0.68,
        'HIGHUNCHANGED': 0.27,
        'HIGHCHANGED': 0.5
    },
    'userInteraction': {
        'NONE': 0.85,
        'REQUIRED': 0.62
    },
    'confidentialityImpact': {
        'NONE': 0,
        'HIGH': 0.56,
        'LOW': 0.22
    },
    'integrityImpact': {
        'NONE': 0,
        'HIGH': 0.56,
        'LOW': 0.22
    },
    'availabilityImpact': {
        'NONE': 0,
        'HIGH': 0.56,
        'LOW': 0.22
    },
}

data = pd.read_csv('final_2017_copy.csv').dropna().reset_index()

# allcols = ['ID', 'description', 'attackVector', 'attackComplexity', 'privilegesRequired', 'userInteraction',
#            'confidentialityImpact', 'integrityImpact', 'availabilityImpact', 'scope']


id = data['ID']
av = data['attackVector']
ac = data['attackComplexity']
pr = data['privilegesRequired']
ui = data['userInteraction']
ci = data['confidentialityImpact']
ii = data['integrityImpact']
ai = data['availabilityImpact']
scope = data['scope']
baseScore = data['baseScore']

n = len(av)

for i in range(n):
    # print(av[i])
    # print(ac[i])
    # print(pr[i])
    # print(ui[i])
    # print(ci[i])
    # print(ii[i])
    # print(ai[i])

    av[i] = map_value['attackVector'][av[i]]
    ac[i] = map_value['attackComplexity'][ac[i]]
    pr[i] = map_value['privilegesRequired'][pr[i] + scope[i]]
    ui[i] = map_value['userInteraction'][ui[i]]
    ci[i] = map_value['confidentialityImpact'][ci[i]]
    ii[i] = map_value['integrityImpact'][ii[i]]
    ai[i] = map_value['availabilityImpact'][ai[i]]
    baseScore[i] = round(int(baseScore[i]))

    print(i)
    print(av[i])
    print(ac[i])
    print(pr[i])
    print(ui[i])
    print(ci[i])
    print(ii[i])
    print(ai[i])
    print(baseScore[i])

data.to_csv('data_for_dt_2017.csv')
print("HAHHAHAHHAHAHAHHAHAHAHH")
