const { DataTypes } = require("sequelize");

module.exports = (sequelize, DataTypes) => {
    const Vulnerability = sequelize.define("Vulnerability", {
        description: {
            type: DataTypes.STRING,
            allowNull: true,
        },
        attackVector: {
            type: DataTypes.STRING,
            allowNull: false,
        },
        attackComplexity: {
            type: DataTypes.STRING,
            allowNull: false,
        },
        privilegesRequired: {
            type: DataTypes.STRING,
            allowNull: false,
        },
        userInteraction: {
            type: DataTypes.STRING,
            allowNull: false,
        },
        scope: {
            type: DataTypes.STRING,
            allowNull: false,
        },
        confidentialityImpact: {
            type: DataTypes.STRING,
            allowNull: false,
        },
        integrityImpact: {
            type: DataTypes.STRING,
            allowNull: false,
        },
        availabilityImpact: {
            type: DataTypes.STRING,
            allowNull: false,
        },
        question1: {
            type: DataTypes.STRING,
            allowNull: true,
        },
        question2: {
            type: DataTypes.STRING,
            allowNull: true,
        },
        question3: {
            type: DataTypes.STRING,
            allowNull: true,
        },
        question4: {
            type: DataTypes.STRING,
            allowNull: true,
        },
        question5: {
            type: DataTypes.STRING,
            allowNull: true,
        },
        question6: {
            type: DataTypes.STRING,
            allowNull: true,
        },
        question7: {
            type: DataTypes.STRING,
            allowNull: true,
        },
        question8: {
            type: DataTypes.STRING,
            allowNull: true,
        },
        question9: {
            type: DataTypes.STRING,
            allowNull: true,
        },
        question10: {
            type: DataTypes.STRING,
            allowNull: true,
        },
        question11: {
            type: DataTypes.STRING,
            allowNull: true,
        },
        question12: {
            type: DataTypes.STRING,
            allowNull: true,
        },
        question13: {
            type: DataTypes.STRING,
            allowNull: true,
        },
        question14: {
            type: DataTypes.STRING,
            allowNull: true,
        },
        baseScore: {
            type: DataTypes.DOUBLE,
            allowNull: true,
        },
        exploitabilityScore: {
            type: DataTypes.DOUBLE,
            allowNull: true,
        },
        impactScore: {
            type: DataTypes.DOUBLE,
            allowNull: true,
        },
        impactSubScore: {
            type: DataTypes.DOUBLE,
            allowNull: true,
        },
        severity: {
            type: DataTypes.STRING,
            allowNull: true,
        },
        userID: {
            type: DataTypes.STRING,
            allowNull: false,
        },
        userName: {
            type: DataTypes.STRING,
            allowNull: false,
        }
    });

    Vulnerability.sync();

    return Vulnerability;
};
